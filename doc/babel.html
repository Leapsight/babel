<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.29.1">
    <meta name="project" content="babel v0.3.11">

    <title>babel â€” babel v0.3.11</title>
    <link rel="stylesheet" href="dist/html-erlang-6FXMBT73.css" />


    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-IV5W3OL2.js"></script>
    <script src="dist/sidebar_items-87E3B8FB.js"></script>

      <script src="docs_config.js"></script>

    <script async src="dist/html-XN2TSG4M.js"></script>


  </head>
  <body data-type="modules" class="page-module">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="main">

<button class="sidebar-button sidebar-toggle" aria-label="toggle sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <i class="ri-search-2-line" aria-hidden="true" title="Submit search"></i>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <i class="ri-close-line ri-lg" aria-hidden="true" title="Cancel search"></i>
    </button>
    <label class="search-label">
      <p class="sr-only">Search</p>
      <input name="q" type="text" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">

    <div class="sidebar-projectDetails">
      <a href="readme.html" class="sidebar-projectName" translate="no">
babel
      </a>
      <strong class="sidebar-projectVersion" translate="no">
        v0.3.11
      </strong>
    </div>
    <ul class="sidebar-listNav">
      <li><a id="extras-list-link" href="#full-list">Pages</a></li>

        <li><a id="modules-list-link" href="#full-list">Modules</a></li>


    </ul>
  </div>

  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <output role="status" id="toast"></output>
  <div class="content-outer">
    <div id="content" class="content-inner">

<h1>
<button class="icon-action display-settings">
  <i class="ri-settings-3-line"></i>
  <span class="sr-only">Settings</span>
</button>


    <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L36" title="View Source" class="icon-action" rel="help">
      <i class="ri-code-s-slash-line" aria-hidden="true"></i>
      <span class="sr-only">View Source</span>
    </a>

  <span translate="no">babel</span> 
  <small class="app-vsn" translate="no">(babel v0.3.11)</small>

</h1>


  <section id="moduledoc">
<p>This module acts as entry point for a number of Babel features and provides some of the <code>riakc_pb_socket</code> module functions adapted for babel datatypes.</p><p>### Working with Babel Datatypes</p><p>### Working with Reliable Workflows #### Workflow aware functions A workflow aware function is a function that schedules its execution when it is called inside a workflow context. Several functions in this module are workflow aware e.g. <a href="#put/5"><code>put/5</code></a>, <a href="#delete/3"><code>delete/3</code></a>.</p>### Working with Babel Indices
  </section>


  <section id="summary" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#summary">
        <i class="ri-link-m" aria-hidden="true"></i>
        <span class="sr-only">Link to this section</span>
      </a>
      Summary
    </h1>
<div class="summary-types summary">
  <h2>
    <a href="#types">Types</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:bucket/0" translate="no">bucket/0</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:bucket_and_type/0" translate="no">bucket_and_type/0</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:bucket_type/0" translate="no">bucket_type/0</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:datatype/0" translate="no">datatype/0</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:delete_opts/0" translate="no">delete_opts/0</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:get_opts/0" translate="no">get_opts/0</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:opts/0" translate="no">opts/0</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:put_opts/0" translate="no">put_opts/0</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:quorum/0" translate="no">quorum/0</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:riak_op/0" translate="no">riak_op/0</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:type_spec/0" translate="no">type_spec/0</a>

      </div>

    </div>

</div>
<div class="summary-functions summary">
  <h2>
    <a href="#functions">Functions</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#create_index/2" translate="no">create_index(Index, Collection)</a>

      </div>

        <div class="summary-synopsis">Calls <a href="#create_index/3"><code>create_index/3</code></a> passing the default options as third argument.</div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#create_index/3" translate="no">create_index(Index, Collection, Opts)</a>

      </div>

        <div class="summary-synopsis"><p>Schedules the creation of an index and its partitions according to <code>Config</code> using Reliable.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#delete/3" translate="no">delete(TypedBucket, Key, Opts)</a>

      </div>

        <div class="summary-synopsis">?&gt; This function is workflow aware</div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#drop_all_indices/1" translate="no">drop_all_indices(Collection)</a>

      </div>

        <div class="summary-synopsis">Calls <code>drop_all_indices/3</code></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#drop_all_indices/2" translate="no">drop_all_indices(Collection, Opts)</a>

      </div>

        <div class="summary-synopsis">Drops all indices in collection by calling <a href="#drop_indices/3"><code>drop_indices/3</code></a>.</div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#drop_index/2" translate="no">drop_index(Index, Collection0)</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#drop_index/3" translate="no">drop_index(Index, Collection, Opts)</a>

      </div>

        <div class="summary-synopsis"><p>Schedules the removal of the index with name <code>IndexName</code> from collection <code>Collection</code> and all its index partitions from Riak KV. In case the collection is itself being dropped by a parent workflow, the collection will not be updated in Riak.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#drop_indices/2" translate="no">drop_indices(IdxNames, Collection)</a>

      </div>

        <div class="summary-synopsis">Calls <a href="#drop_indices/3"><code>drop_indices/3</code></a></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#drop_indices/3" translate="no">drop_indices(IdxNames, Collection, Opts)</a>

      </div>

        <div class="summary-synopsis"><p>Schedules the removal from Riak KV of indices with names <code>IdxNames</code> from collection <code>Collection</code> and their respective partitions.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#execute/3" translate="no">execute(Poolname, Fun, Opts)</a>

      </div>

        <div class="summary-synopsis"><p>Executes a number of operations using the same Riak client connection provided by riak_pool app. <code>Poolname</code> must be an already started pool or the atom <code>undefined</code>. In case of the latter the map <code>Options</code> should have an entry for the <code>connection</code> key.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#get/4" translate="no">get(TypedBucket, Key, Spec, Opts)</a>

      </div>

        <div class="summary-synopsis"><p>Retrieves a Riak Datatype (counter, set or map) from bucket type and bucket <code>TypedBucket</code> and key <code>Key</code>. It uses type spec <code>Spec</code> to transform the Riak Datatype into a Babel Datatype and if successful returns <code>{ok, Datatype}</code> where Datatype is one of <a href="babel_counter.html"><code>babel_counter</code></a>, <a href="babel_set.html"><code>babel_set</code></a> or <a href="babel_map.html"><code>babel_map</code></a>. Returns <code>{error, not_found}</code> if the key is not on the server.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#get_connection/0" translate="no">get_connection()</a>

      </div>

        <div class="summary-synopsis">Returns a Riak connection managed by <code>riak_pool</code> from the process dictonary or <code>undefined</code> if there is none.</div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#module/1" translate="no">module(Term)</a>

      </div>

        <div class="summary-synopsis">Returns the module associated with the type of term <code>Term</code>.</div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#opts_to_riak_opts/1" translate="no">opts_to_riak_opts(Opts)</a>

      </div>

        <div class="summary-synopsis">Converts the options map into Riak KV property list format. It fails with a badarg exception if <code>Opts</code> is not the result of <a href="#validate_opts/3"><code>validate_opts/3</code></a>.</div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#put/5" translate="no">put(TypedBucket, Key, Datatype, Spec, Opts)</a>

      </div>

        <div class="summary-synopsis"><p>Transforms the datatype <code>Datatype</code> to a Riak Datatype using type specification <code>Spec</code> and stores it under <code>TypedBucket</code> and <code>Key</code> using options <code>Opts. When called outside a workflow it returns `ok</code> or <code>{error, Reason}</code>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#rebuild_index/3" translate="no">rebuild_index(Index, Collection, Opts)</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#status/1" translate="no">status(WorkRef)</a>

      </div>

        <div class="summary-synopsis">Calls <a href="#status/2"><code>status/2</code></a>.</div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#status/2" translate="no">status(WorkRef, Timeout)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the status of a Reliable Work scheduled for execution.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#type/1" translate="no">type(Term)</a>

      </div>

        <div class="summary-synopsis">Returns the atom name for a babel datatype.</div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#update_all_indices/3" translate="no">update_all_indices(Actions, Collection, Opts)</a>

      </div>

        <div class="summary-synopsis"><p>Updates all the indices in the collection that are affected by he provided Actions and schedules the update of the relevant index partitions in the database i.e. persisting the index changes.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#update_indices/3" translate="no">update_indices(ActionsByIdxName, Collection, Opts)</a>

      </div>

        <div class="summary-synopsis"><p>Updates all the indices in the collection with the provided Actions and schedules the update of the relevant index partitions in the database i.e. persisting the index changes.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#update_indices/4" translate="no">update_indices(Actions, IdxNames, Collection, Opts)</a>

      </div>

        <div class="summary-synopsis"><p>Updates all the indices in the collection with the provided Actions and schedules the update of the relevant index partitions in the database i.e. persisting the index changes.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#validate_opts/2" translate="no">validate_opts(Op, Opts)</a>

      </div>

        <div class="summary-synopsis"><p>Equivalent to <a href="#validate_opts/3">validate_opts(Op, Opts, strict)</a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#validate_opts/3" translate="no">validate_opts(Operation, Opts, Mode)</a>

      </div>

        <div class="summary-synopsis">Validates the options</div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#workflow/1" translate="no">workflow(Fun)</a>

      </div>

        <div class="summary-synopsis"><p>Equivalent to calling <a href="#workflow/2"><code>workflow/2</code></a> with and empty map passed as the <code>Opts</code> argument.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#workflow/2" translate="no">workflow(Fun, Opts)</a>

      </div>

        <div class="summary-synopsis"><p>Executes the functional object <code>Fun</code> as a Reliable workflow, i.e. ordering and scheduling all resulting Riak KV object writes.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#yield/1" translate="no">yield(WorkRef)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the value associated with the key <code>event_payload</code> when used as option from a previous <code>enqueue/2</code>. The calling process is suspended until the work is completed or</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#yield/2" translate="no">yield(WorkRef, Timeout)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the value associated with the key <code>event_payload</code> when used as option from a previous <code>enqueue/2</code> or <code>timeout</code> when <code>Timeout</code> milliseconds has elapsed.</p></div>

    </div>

</div>

  </section>


  <section id="types" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#types">
        <i class="ri-link-m" aria-hidden="true"></i>
        <span class="sr-only">Link to this section</span>
      </a>
Types
    </h1>
    <div class="types-list">
<section class="detail" id="t:bucket/0">

  <div class="detail-header">
    <a href="#t:bucket/0" class="detail-link" title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">bucket/0</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L45" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> bucket() :: binary().</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:bucket_and_type/0">

  <div class="detail-header">
    <a href="#t:bucket_and_type/0" class="detail-link" title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">bucket_and_type/0</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L47" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> bucket_and_type() :: {<a href="#t:bucket_type/0">bucket_type</a>(), <a href="#t:bucket/0">bucket</a>()}.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:bucket_type/0">

  <div class="detail-header">
    <a href="#t:bucket_type/0" class="detail-link" title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">bucket_type/0</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L46" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> bucket_type() :: binary().</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:datatype/0">

  <div class="detail-header">
    <a href="#t:datatype/0" class="detail-link" title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">datatype/0</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L44" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> datatype() :: <a href="babel_map.html#t:t/0">babel_map:t</a>() | <a href="babel_set.html#t:t/0">babel_set:t</a>() | <a href="babel_counter.html#t:t/0">babel_counter:t</a>().</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:delete_opts/0">

  <div class="detail-header">
    <a href="#t:delete_opts/0" class="detail-link" title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">delete_opts/0</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L88" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> delete_opts() ::
    #{connection => pid(),
      connection_pool => atom(),
      r => <a href="#t:quorum/0">quorum</a>(),
      pr => <a href="#t:quorum/0">quorum</a>(),
      w => <a href="#t:quorum/0">quorum</a>(),
      dw => <a href="#t:quorum/0">quorum</a>(),
      pw => <a href="#t:quorum/0">quorum</a>(),
      n_val => non_neg_integer(),
      sloppy_quorum => boolean(),
      timeout => timeout(),
      '$delete_validated' => boolean()}.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:get_opts/0">

  <div class="detail-header">
    <a href="#t:get_opts/0" class="detail-link" title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">get_opts/0</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L52" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> get_opts() ::
    #{connection => pid(),
      connection_pool => atom(),
      r => <a href="#t:quorum/0">quorum</a>(),
      pr => <a href="#t:quorum/0">quorum</a>(),
      cache => boolean(),
      cache_force_refresh => boolean(),
      if_modified => binary(),
      notfound_ok => boolean(),
      n_val => non_neg_integer(),
      basic_quorum => boolean(),
      sloppy_quorum => boolean(),
      head => boolean(),
      deletedvclock => boolean(),
      timeout => timeout(),
      '$get_validated' => boolean()}.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:opts/0">

  <div class="detail-header">
    <a href="#t:opts/0" class="detail-link" title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">opts/0</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L50" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> opts() :: <a href="#t:get_opts/0">get_opts</a>() | <a href="#t:put_opts/0">put_opts</a>() | <a href="#t:delete_opts/0">delete_opts</a>().</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:put_opts/0">

  <div class="detail-header">
    <a href="#t:put_opts/0" class="detail-link" title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">put_opts/0</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L70" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> put_opts() ::
    #{connection => pid(),
      connection_pool => atom(),
      cache => boolean(),
      w => <a href="#t:quorum/0">quorum</a>(),
      dw => <a href="#t:quorum/0">quorum</a>(),
      pw => <a href="#t:quorum/0">quorum</a>(),
      if_not_modified => boolean(),
      if_none_match => boolean(),
      notfound_ok => boolean(),
      n_val => non_neg_integer(),
      sloppy_quorum => boolean(),
      return_body => boolean(),
      return_head => boolean(),
      timeout => timeout(),
      '$put_validated' => boolean()}.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:quorum/0">

  <div class="detail-header">
    <a href="#t:quorum/0" class="detail-link" title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">quorum/0</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L55" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> quorum() :: non_neg_integer() | one | all | quorum | default.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:riak_op/0">

  <div class="detail-header">
    <a href="#t:riak_op/0" class="detail-link" title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">riak_op/0</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L48" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> riak_op() :: <a href="https://hexdocs.pm/riakc/riakc_datatype.html#t:update/1">riakc_datatype:update</a>(term()).</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:type_spec/0">

  <div class="detail-header">
    <a href="#t:type_spec/0" class="detail-link" title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">type_spec/0</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L45" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> type_spec() :: <a href="babel_map.html#t:type_spec/0">babel_map:type_spec</a>() | <a href="babel_set.html#t:type_spec/0">babel_set:type_spec</a>() | <a href="babel_counter.html#t:type_spec/0">babel_counter:type_spec</a>().</pre>

      </div>


  </section>
</section>

    </div>
  </section>

  <section id="functions" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#functions">
        <i class="ri-link-m" aria-hidden="true"></i>
        <span class="sr-only">Link to this section</span>
      </a>
Functions
    </h1>
    <div class="functions-list">
<section class="detail" id="create_index/2">

  <div class="detail-header">
    <a href="#create_index/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">create_index(Index, Collection)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L593" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> create_index(Index :: <a href="babel_index.html#t:t/0">babel_index:t</a>(), Collection :: <a href="babel_index_collection.html#t:t/0">babel_index_collection:t</a>()) ->
                {true | false, <a href="https://hexdocs.pm/reliable/reliable.html#t:wf_result/0">reliable:wf_result</a>()} | {error, Reason :: any()} | no_return().</pre>

      </div>

Calls <a href="#create_index/3"><code>create_index/3</code></a> passing the default options as third argument.
  </section>
</section>
<section class="detail" id="create_index/3">

  <div class="detail-header">
    <a href="#create_index/3" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">create_index(Index, Collection, Opts)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L617" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> create_index(Index :: <a href="babel_index.html#t:t/0">babel_index:t</a>(), Collection :: <a href="babel_index_collection.html#t:t/0">babel_index_collection:t</a>(), Opts :: <a href="#t:opts/0">opts</a>()) ->
                {true | false, <a href="https://hexdocs.pm/reliable/reliable.html#t:wf_result/0">reliable:wf_result</a>()} | {error, Reason :: any()} | no_return().</pre>

      </div>

<p>Schedules the creation of an index and its partitions according to <code>Config</code> using Reliable.</p><p>The updated collection is returned under the key <code>result</code> of the <code>reliable:wf_result()</code>.</p>?&gt; This function uses a workflow, see <a href="#workflow/2"><code>workflow/2</code></a> for an explanation of the possible return values.
  </section>
</section>
<section class="detail" id="delete/3">

  <div class="detail-header">
    <a href="#delete/3" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">delete(TypedBucket, Key, Opts)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L295" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> delete(TypedBucket :: <a href="#t:bucket_and_type/0">bucket_and_type</a>(), Key :: binary(), Opts :: <a href="#t:delete_opts/0">delete_opts</a>()) ->
          ok | {true | false, <a href="https://hexdocs.pm/reliable/reliable.html#t:wf_result/0">reliable:wf_result</a>()} | {error, Reason :: any()} | no_return().</pre>

      </div>

?&gt; This function is workflow aware
  </section>
</section>
<section class="detail" id="drop_all_indices/1">

  <div class="detail-header">
    <a href="#drop_all_indices/1" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">drop_all_indices(Collection)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L926" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> drop_all_indices(Collection :: <a href="babel_index_collection.html#t:t/0">babel_index_collection:t</a>()) ->
                    {true | false, <a href="https://hexdocs.pm/reliable/reliable.html#t:wf_result/0">reliable:wf_result</a>()} | {error, Reason :: any()} | no_return().</pre>

      </div>

Calls <code>drop_all_indices/3</code>
  </section>
</section>
<section class="detail" id="drop_all_indices/2">

  <div class="detail-header">
    <a href="#drop_all_indices/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">drop_all_indices(Collection, Opts)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L941" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> drop_all_indices(Collection :: <a href="babel_index_collection.html#t:t/0">babel_index_collection:t</a>(), Opts :: <a href="#t:opts/0">opts</a>()) ->
                    {true | false, <a href="https://hexdocs.pm/reliable/reliable.html#t:wf_result/0">reliable:wf_result</a>()} | {error, Reason :: any()} | no_return().</pre>

      </div>

Drops all indices in collection by calling <a href="#drop_indices/3"><code>drop_indices/3</code></a>.
  </section>
</section>
<section class="detail" id="drop_index/2">

  <div class="detail-header">
    <a href="#drop_index/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">drop_index(Index, Collection0)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L800" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> drop_index(Index :: binary(), Collection0 :: <a href="babel_index_collection.html#t:t/0">babel_index_collection:t</a>()) ->
              {true | false, <a href="https://hexdocs.pm/reliable/reliable.html#t:wf_result/0">reliable:wf_result</a>()} | {error, Reason :: any()} | no_return().</pre>

      </div>


  </section>
</section>
<section class="detail" id="drop_index/3">

  <div class="detail-header">
    <a href="#drop_index/3" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">drop_index(Index, Collection, Opts)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L822" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> drop_index(Index :: binary(), Collection :: <a href="babel_index_collection.html#t:t/0">babel_index_collection:t</a>(), Opts :: <a href="#t:opts/0">opts</a>()) ->
              {true | false, <a href="https://hexdocs.pm/reliable/reliable.html#t:wf_result/0">reliable:wf_result</a>()} | {error, Reason :: any()} | no_return().</pre>

      </div>

<p>Schedules the removal of the index with name <code>IndexName</code> from collection <code>Collection</code> and all its index partitions from Riak KV. In case the collection is itself being dropped by a parent workflow, the collection will not be updated in Riak.</p>?&gt; This function uses a workflow, see <a href="#workflow/2"><code>workflow/2</code></a> for an explanation of the possible return values.
  </section>
</section>
<section class="detail" id="drop_indices/2">

  <div class="detail-header">
    <a href="#drop_indices/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">drop_indices(IdxNames, Collection)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L880" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> drop_indices(IdxNames :: [binary()], Collection :: <a href="babel_index_collection.html#t:t/0">babel_index_collection:t</a>()) ->
                {true | false, <a href="https://hexdocs.pm/reliable/reliable.html#t:wf_result/0">reliable:wf_result</a>()} | {error, Reason :: any()} | no_return().</pre>

      </div>

Calls <a href="#drop_indices/3"><code>drop_indices/3</code></a>
  </section>
</section>
<section class="detail" id="drop_indices/3">

  <div class="detail-header">
    <a href="#drop_indices/3" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">drop_indices(IdxNames, Collection, Opts)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L900" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> drop_indices(IdxNames :: [binary()], Collection :: <a href="babel_index_collection.html#t:t/0">babel_index_collection:t</a>(), Opts :: <a href="#t:opts/0">opts</a>()) ->
                {true | false, <a href="https://hexdocs.pm/reliable/reliable.html#t:wf_result/0">reliable:wf_result</a>()} | {error, Reason :: any()} | no_return().</pre>

      </div>

<p>Schedules the removal from Riak KV of indices with names <code>IdxNames</code> from collection <code>Collection</code> and their respective partitions.</p>?&gt; This function uses a workflow, see <a href="#workflow/2"><code>workflow/2</code></a> for an explanation of the possible return values.
  </section>
</section>
<section class="detail" id="execute/3">

  <div class="detail-header">
    <a href="#execute/3" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">execute(Poolname, Fun, Opts)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L325" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> execute(Poolname :: atom(),
        Fun :: fun((RiakConn :: pid()) -> Result :: any()),
        Opts :: riak_pool:opts()) ->
           {ok, Result :: any()} | {error, Reason :: any()} | no_return().</pre>

      </div>

<p>Executes a number of operations using the same Riak client connection provided by riak_pool app. <code>Poolname</code> must be an already started pool or the atom <code>undefined</code>. In case of the latter the map <code>Options</code> should have an entry for the <code>connection</code> key.</p><p>Options:</p>* timeout - time to get a connection from the pool * connection - the pid to use instead of getting a new one from the pool
  </section>
</section>
<section class="detail" id="get/4">

  <div class="detail-header">
    <a href="#get/4" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">get(TypedBucket, Key, Spec, Opts)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L223" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> get(TypedBucket :: <a href="#t:bucket_and_type/0">bucket_and_type</a>(), Key :: binary(), Spec :: <a href="#t:type_spec/0">type_spec</a>(), Opts :: <a href="#t:get_opts/0">get_opts</a>()) ->
       {ok, Datatype :: <a href="#t:datatype/0">datatype</a>()} | {error, Reason :: term()}.</pre>

      </div>

<p>Retrieves a Riak Datatype (counter, set or map) from bucket type and bucket <code>TypedBucket</code> and key <code>Key</code>. It uses type spec <code>Spec</code> to transform the Riak Datatype into a Babel Datatype and if successful returns <code>{ok, Datatype}</code> where Datatype is one of <a href="babel_counter.html"><code>babel_counter</code></a>, <a href="babel_set.html"><code>babel_set</code></a> or <a href="babel_map.html"><code>babel_map</code></a>. Returns <code>{error, not_found}</code> if the key is not on the server.</p><p>This function gets the riak client connection from the options <code>Opts</code> under the key <code>connection</code> which can have the connection pid or a function object returning a connection pid. This allows a lot of flexibility such as reusing a given connection over several calls and using your own connection pool and management.</p>In case the <code>connection</code> option does not provide a connection as explained above, this function tries to get a connection from the the <code>default</code> riak_pool connection pool if it was enabled through Babel's configuration options.
  </section>
</section>
<section class="detail" id="get_connection/0">

  <div class="detail-header">
    <a href="#get_connection/0" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">get_connection()</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L336" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> get_connection() -> undefined | pid().</pre>

      </div>

Returns a Riak connection managed by <code>riak_pool</code> from the process dictonary or <code>undefined</code> if there is none.
  </section>
</section>
<section class="detail" id="module/1">

  <div class="detail-header">
    <a href="#module/1" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">module(Term)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L170" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> module(Term :: any()) -> module() | undefined.</pre>

      </div>

Returns the module associated with the type of term <code>Term</code>.
  </section>
</section>
<section class="detail" id="opts_to_riak_opts/1">

  <div class="detail-header">
    <a href="#opts_to_riak_opts/1" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">opts_to_riak_opts(Opts)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L391" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> opts_to_riak_opts(map()) -> list().</pre>

      </div>

Converts the options map into Riak KV property list format. It fails with a badarg exception if <code>Opts</code> is not the result of <a href="#validate_opts/3"><code>validate_opts/3</code></a>.
  </section>
</section>
<section class="detail" id="put/5">

  <div class="detail-header">
    <a href="#put/5" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">put(TypedBucket, Key, Datatype, Spec, Opts)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L272" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> put(TypedBucket :: <a href="#t:bucket_and_type/0">bucket_and_type</a>(),
    Key :: binary(),
    Datatype :: <a href="#t:datatype/0">datatype</a>(),
    Spec :: <a href="#t:type_spec/0">type_spec</a>(),
    Opts :: <a href="#t:put_opts/0">put_opts</a>()) ->
       ok |
       {ok, <a href="babel.html#t:datatype/0">babel:datatype</a>()} |
       {ok, binary(), <a href="babel.html#t:datatype/0">babel:datatype</a>()} |
       {true | false, <a href="https://hexdocs.pm/reliable/reliable.html#t:wf_result/0">reliable:wf_result</a>()} |
       {error, Reason :: any()} |
       no_return().</pre>

      </div>

<p>Transforms the datatype <code>Datatype</code> to a Riak Datatype using type specification <code>Spec</code> and stores it under <code>TypedBucket</code> and <code>Key</code> using options <code>Opts. When called outside a workflow it returns `ok</code> or <code>{error, Reason}</code>.</p>?&gt; This function is workflow aware. See <a href="#workflow/2"><code>workflow/2</code></a> to understand the result value.
  </section>
</section>
<section class="detail" id="rebuild_index/3">

  <div class="detail-header">
    <a href="#rebuild_index/3" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">rebuild_index(Index, Collection, Opts)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L652" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> rebuild_index(Index :: <a href="babel_index.html#t:t/0">babel_index:t</a>(), Collection :: <a href="babel_index_collection.html#t:t/0">babel_index_collection:t</a>(), Opts :: <a href="#t:opts/0">opts</a>()) ->
                 {true | false, <a href="https://hexdocs.pm/reliable/reliable.html#t:wf_result/0">reliable:wf_result</a>()} | {error, Reason :: any()} | no_return().</pre>

      </div>


  </section>
</section>
<section class="detail" id="status/1">

  <div class="detail-header">
    <a href="#status/1" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">status(WorkRef)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L518" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> status(WorkRef :: <a href="https://hexdocs.pm/reliable/reliable_work_ref.html#t:t/0">reliable_work_ref:t</a>() | binary()) ->
          {in_progress, Status :: <a href="https://hexdocs.pm/reliable/reliable_work.html#t:status/0">reliable_work:status</a>()} |
          {failed, Status :: <a href="https://hexdocs.pm/reliable/reliable_work.html#t:status/0">reliable_work:status</a>()} |
          {error, not_found | any()}.</pre>

      </div>

Calls <a href="#status/2"><code>status/2</code></a>.
  </section>
</section>
<section class="detail" id="status/2">

  <div class="detail-header">
    <a href="#status/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">status(WorkRef, Timeout)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L537" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> status(WorkRef :: <a href="https://hexdocs.pm/reliable/reliable_work_ref.html#t:t/0">reliable_work_ref:t</a>() | binary(), Timeout :: timeout()) ->
          {in_progress, Status :: <a href="https://hexdocs.pm/reliable/reliable_work.html#t:status/0">reliable_work:status</a>()} |
          {failed, Status :: <a href="https://hexdocs.pm/reliable/reliable_work.html#t:status/0">reliable_work:status</a>()} |
          {error, not_found | any()}.</pre>

      </div>

<p>Returns the status of a Reliable Work scheduled for execution.</p>!&gt; **Important** notice that at the moment completed tasks are deleted, so the abscense of a task is considered as either successful or failed, this will change in the near future as we will be retaining tasks that are discarded or completed.
  </section>
</section>
<section class="detail" id="type/1">

  <div class="detail-header">
    <a href="#type/1" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">type(Term)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L157" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> type(term()) -> set | map | counter | flag | register.</pre>

      </div>

Returns the atom name for a babel datatype.
  </section>
</section>
<section class="detail" id="update_all_indices/3">

  <div class="detail-header">
    <a href="#update_all_indices/3" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">update_all_indices(Actions, Collection, Opts)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L785" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> update_all_indices(Actions :: [<a href="babel_index.html#t:update_action/0">babel_index:update_action</a>()],
                   Collection :: <a href="babel_index_collection.html#t:t/0">babel_index_collection:t</a>(),
                   Opts :: <a href="babel_index.html#t:update_opts/0">babel_index:update_opts</a>()) ->
                      {true | false, <a href="https://hexdocs.pm/reliable/reliable.html#t:wf_result/0">reliable:wf_result</a>()} |
                      {error, Reason :: any()} |
                      no_return().</pre>

      </div>

<p>Updates all the indices in the collection that are affected by he provided Actions and schedules the update of the relevant index partitions in the database i.e. persisting the index changes.</p><p>An index in collection <code>Collection</code> will always be affectd in case the action is either <code>{insert, Data}</code> or <code>{delete, Data}</code> or when the action is <code>{udpate, Old, New}</code> and the option <code>force</code> was set to <code>true</code> or when <code>New</code> is not a babel map.</p><p>In case option object <code>New</code> is a babel map, and the option <code>force</code> is missing or set to <code>false</code>, an index will be affected by an update action only if the index's distinguished key paths have been updated or removed in the object <code>New</code> (See <a href="babel_index.html#distinguished_key_paths/1"><code>babel_index:distinguished_key_paths/1</code></a>)</p>?&gt; This function uses a workflow, see <a href="#workflow/2"><code>workflow/2</code></a> for an explanation of the possible return values.
  </section>
</section>
<section class="detail" id="update_indices/3">

  <div class="detail-header">
    <a href="#update_indices/3" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">update_indices(ActionsByIdxName, Collection, Opts)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L678" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> update_indices(ActionsByIdxName :: {[<a href="babel_index.html#t:update_action/0">babel_index:update_action</a>()], binary()},
               Collection :: <a href="babel_index_collection.html#t:t/0">babel_index_collection:t</a>(),
               Opts :: <a href="babel_index.html#t:update_opts/0">babel_index:update_opts</a>()) ->
                  {true | false, <a href="https://hexdocs.pm/reliable/reliable.html#t:wf_result/0">reliable:wf_result</a>()} | {error, Reason :: any()} | no_return().</pre>

      </div>

<p>Updates all the indices in the collection with the provided Actions and schedules the update of the relevant index partitions in the database i.e. persisting the index changes.</p><p>The names of the updated indices is returned under the key <code>result</code> of the <code>reliable:wf_result()</code>.</p>?&gt; This function uses a workflow, see <a href="#workflow/2"><code>workflow/2</code></a> for an explanation of the possible return values.
  </section>
</section>
<section class="detail" id="update_indices/4">

  <div class="detail-header">
    <a href="#update_indices/4" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">update_indices(Actions, IdxNames, Collection, Opts)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L753" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> update_indices(Actions :: [<a href="babel_index.html#t:update_action/0">babel_index:update_action</a>()],
               IdxNames :: [binary()],
               Collection :: <a href="babel_index_collection.html#t:t/0">babel_index_collection:t</a>(),
               Opts :: <a href="babel_index.html#t:update_opts/0">babel_index:update_opts</a>()) ->
                  {true | false, <a href="https://hexdocs.pm/reliable/reliable.html#t:wf_result/0">reliable:wf_result</a>()} | {error, Reason :: any()} | no_return().</pre>

      </div>

<p>Updates all the indices in the collection with the provided Actions and schedules the update of the relevant index partitions in the database i.e. persisting the index changes.</p><p>The names of the updated indices is returned under the key <code>result</code> of the <code>reliable:wf_result()</code>.</p>?&gt; This function uses a workflow, see <a href="#workflow/2"><code>workflow/2</code></a> for an explanation of the possible return values.
  </section>
</section>
<section class="detail" id="validate_opts/2">

  <div class="detail-header">
    <a href="#validate_opts/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">validate_opts(Op, Opts)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L350" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> validate_opts(Op :: get | put | delete, Opts :: map()) -> <a href="#t:opts/0">opts</a>().</pre>

      </div>

<p>Equivalent to <a href="#validate_opts/3">validate_opts(Op, Opts, strict)</a>.</p>Validates the options <code>Opts</code> for an operation <code>Op</code>.<p><em>See also: </em><a href="#validate_opts/3">validate_opts/3</a>.</p>
  </section>
</section>
<section class="detail" id="validate_opts/3">

  <div class="detail-header">
    <a href="#validate_opts/3" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">validate_opts(Operation, Opts, Mode)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L363" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> validate_opts(Operation :: get | put | delete, Opts :: map(), Mode :: strict | relaxed) -> <a href="#t:opts/0">opts</a>().</pre>

      </div>

Validates the options
  </section>
</section>
<section class="detail" id="workflow/1">

  <div class="detail-header">
    <a href="#workflow/1" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">workflow(Fun)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L425" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> workflow(Fun :: fun(() -> any())) ->
            {true | false, <a href="https://hexdocs.pm/reliable/reliable.html#t:wf_result/0">reliable:wf_result</a>()} | {error, Reason :: any()} | no_return().</pre>

      </div>

<p>Equivalent to calling <a href="#workflow/2"><code>workflow/2</code></a> with and empty map passed as the <code>Opts</code> argument.</p>&gt; Notice subscriptions are not working at the moment &gt; See <a href="#yield/2"><code>yield/2</code></a> to track progress.
  </section>
</section>
<section class="detail" id="workflow/2">

  <div class="detail-header">
    <a href="#workflow/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">workflow(Fun, Opts)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L505" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> workflow(Fun :: fun(() -> any()), Opts :: babel_workflow:opts()) ->
            {true | false, <a href="https://hexdocs.pm/reliable/reliable.html#t:wf_result/0">reliable:wf_result</a>()} | {error, Reason :: any()} | no_return().</pre>

      </div>

<p>Executes the functional object <code>Fun</code> as a Reliable workflow, i.e. ordering and scheduling all resulting Riak KV object writes.</p><p>The code that executes inside the workflow should call one or more functions in this module to schedule writes in Riak KV. For example, if you wanted to schedule an index creation you should use <a href="#create_index/2"><code>create_index/2</code></a> instead of <a href="babel_index_collection.html"><code>babel_index_collection</code></a>, <a href="babel_index.html"><code>babel_index</code></a> and <a href="babel_index_partition.html"><code>babel_index_partition</code></a> functions directly.</p><p>Any other operation, including reading and writing from/to Riak KV directly or by using the API provided by other Babel modules will work as normal and will not affect the workflow, only the special functions in this module will add work items to the workflow.</p><p>If something goes wrong inside the workflow as a result of a user error or general exception, the entire workflow is terminated and the function raises an exception. In case of an internal error, the function returns the tuple <code>{error, Reason}</code>.</p><p>If everything goes well, the function returns the tuple <code>{Flag, Result}}</code> where <code>Flag</code> is a boolean denoting whether a workflow was scheduled or not, and Result is a <code>reliable:wf_result()</code> structure.</p><p>&gt; Notice that calling this function schedules the work to Reliable, you need to use the WorkId to check with Reliable the status of the workflow execution.</p><p>Example: Creating various babel objects and scheduling</p><pre lang="erlang"><code>  babel:workflow(fun() -&gt;
   CollectionX0 = babel_index_collection:new(&lt;&lt;&quot;foo&quot;&gt;&gt;, &lt;&lt;&quot;bar&quot;&gt;&gt;),
   CollectionY0 = babel_index_collection:fetch(Conn, &lt;&lt;&quot;foo&quot;&gt;&gt;, &lt;&lt;&quot;users&quot;&gt;&gt;),
   IndexA = babel_index:new(ConfigA),
   IndexB = babel_index:new(ConfigB),
   _CollectionX1 = babel:create_index(IndexA, CollectionX0),
   _CollectionY1 = babel:create_index(IndexB, CollectionY0),
   ok
  end).
  </code></pre><p>The resulting workflow execution will schedule the writes and deletes in the order defined by the dependency graph constructed using the results of this module functions. This ensures partitions are created first and then collections.</p><p>The <code>Opts</code> argument offers the following options:</p><p>* <code>on_terminate` â€“ a functional object `fun((Reason :: any()) -&gt; ok)</code>. This function will be evaluated before the call terminates. In case of succesful termination the value <code>normal</code> will be passed as argument. Otherwise, in case of error, the error reason will be passed as argument. This allows you to perform a cleanup after the workflow execution e.g. returning a riak connection object to a pool. Notice that this function might be called multiple times in the case of nested workflows. If you need to conditionally perform a cleanup operation you might use the function <code>is_nested_worflow/0</code> to take a decision.</p><p>!&gt; **Important** notice subscriptions are not working at the moment</p><p>?&gt; **Tip** See <a href="#yield/2"><code>yield/2</code></a> to track progress.</p>?&gt; **Note on Nested workflows**. No final scheduling will be done until the top level workflow is terminated. So, although a nested worflow returns <code>{true, Result}</code>, if the enclosing parent workflow is aborted, the entire nested workflow is aborted.
  </section>
</section>
<section class="detail" id="yield/1">

  <div class="detail-header">
    <a href="#yield/1" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">yield(WorkRef)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L558" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> yield(WorkRef :: reliable_worker:work_ref()) -> {ok, Payload :: any()} | timeout.</pre>

      </div>

<p>Returns the value associated with the key <code>event_payload</code> when used as option from a previous <code>enqueue/2</code>. The calling process is suspended until the work is completed or</p>!&gt; **Important** notice the current implementation is not ideal as it recursively reads the status from the database. So do not abuse it. Also at the moment completed tasks are deleted, so the abscense of a task is considered as either successful or failed, this will also change as we will be retaining tasks that are discarded or completed. This will be replaced by a pubsub version soon.
  </section>
</section>
<section class="detail" id="yield/2">

  <div class="detail-header">
    <a href="#yield/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">yield(WorkRef, Timeout)</h1>

      <a href="https://github.com/leapsight/babel/blob/v0.3.11/src/babel.erl#L578" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> yield(WorkRef :: reliable_worker:work_ref(), Timeout :: timeout()) ->
         {ok, Payload :: any()} | timeout.</pre>

      </div>

<p>Returns the value associated with the key <code>event_payload</code> when used as option from a previous <code>enqueue/2</code> or <code>timeout</code> when <code>Timeout</code> milliseconds has elapsed.</p>!&gt; **Important** notice The current implementation is not ideal as it recursively reads the status from the database. So do not abuse it. Also at the moment complete tasks are deleted, so the abscense of a task is considered as either succesful or failed, this will also change as we will be retaining tasks that are discarded or completed. This will be replaced by a pubsub version soon.
  </section>
</section>

    </div>
  </section>

      <footer class="footer">
        <p>

            <span class="line">
              <a href="https://hex.pm/packages/babel/0.3.11" class="footer-hex-package">Hex Package</a>

              <a href="https://preview.hex.pm/preview/babel/0.3.11">Hex Preview</a>

                (<a href="https://preview.hex.pm/preview/babel/0.3.11/show/src/babel.erl">current file</a>)

            </span>

          <span class="line">
            <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
              Search HexDocs
            </button>

              <a href="babel.epub" title="ePub version">
                Download ePub version
              </a>

          </span>
        </p>

        <p class="built-using">
          Built using
          <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.29.1) for the

            <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

        </p>
      </footer>
    </div>
  </div>
</section>
</div>


  </body>
</html>
